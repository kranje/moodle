YUI.add("moodle-mod_panoptosubmission-submissionpanel",function(u,t){var e=function(){e.superclass.constructor.apply(this,arguments)};u.extend(e,u.Base,{courseid:null,init:function(t){"0"!==t.addvidbtnid&&"0"!==t.ltilaunchurl&&0!==t.courseid&&0!==t.height&&0!==t.width&&(this.courseid=t.courseid,u.one("#"+t.addvidbtnid).on("click",this.open_panopto_window_callback,this,t.ltilaunchurl,t.height,t.width))},open_panopto_window_callback:function(t,e,i,n){var o=new M.core.dialogue({bodyContent:'<iframe src="'+e+'" width="100%" height="100%"></iframe>',headerContent:M.util.get_string("select_submission","panoptosubmission"),width:n,height:i,draggable:!1,visible:!0,zindex:100,modal:!0,focusOnPreviousTargetAfterHide:!0,render:!0});document.body.panoptoWindow=o,document.body.addEventListener("sessionSelected",this.close_popup_callback.bind(this),!1)},close_popup_callback:function(t){u.one("input[id=submit_video]").removeAttribute("disabled");var e=u.one("iframe[id=contentframe]"),i=u.one("div[id=contentcontainer]"),n=u.one("img[id=panoptothumbnail]"),o=u.one("a[id=panoptothumbnaillink]"),s=u.one("a[id=panoptosessiontitle]"),d=new URL(t.detail.ltiViewerUrl),a=d.searchParams;a.set("course",this.courseid),a.set("custom",decodeURI(t.detail.customData)),a.set("contentUrl",t.detail.contentUrl),d.search=a.toString(),u.one("input[id=sessiontitle]").setAttribute("value",t.detail.title),u.one("input[id=source]").setAttribute("value",t.detail.contentUrl),u.one("input[id=customdata]").setAttribute("value",t.detail.customData),u.one("input[id=width]").setAttribute("value",t.detail.width),u.one("input[id=height]").setAttribute("value",t.detail.height),u.one("input[id=thumbnailsource]").setAttribute("value",t.detail.thumbnailUrl),u.one("input[id=thumbnailwidth]").setAttribute("value",t.detail.thumbnailWidth),u.one("input[id=thumbnailheight]").setAttribute("value",t.detail.thumbnailHeight),s.setContent(t.detail.title),s.setAttribute("href",d.toString()),o.setAttribute("href",d.toString()),n.setAttribute("src",t.detail.thumbnailUrl),n.setAttribute("width",t.detail.thumbnailWidth),n.setAttribute("height",t.detail.thumbnailHeight),e.setAttribute("width",t.detail.width),e.setAttribute("height",t.detail.height),e.hasClass("session-hidden")||e.setAttribute("src",d.toString()),i.removeClass("no-session"),u.one("#id_add_video").set("value",M.util.get_string("replacevideo","panoptosubmission")),u.one("#id_add_video").addClass("btn-secondary"),u.one("#submit_video").addClass("btn-primary"),u.one("#id_add_video").removeClass("btn-primary"),u.one("#submit_video").removeClass("btn-secondary"),document.body.panoptoWindow.destroy()}},{NAME:"moodle-mod_panoptosubmission-submissionpanel",ATTRS:{addvidbtnid:{value:"0"},ltilaunchurl:{value:"0"},height:{value:0},width:{value:0},courseid:{value:0}}}),M.mod_panoptosubmission=M.mod_panoptosubmission||{},M.mod_panoptosubmission.initsubmissionpanel=function(t){return new e(t)}},"@VERSION@",{requires:["base","node","panel","moodle-core-notification","node-event-simulate"]});