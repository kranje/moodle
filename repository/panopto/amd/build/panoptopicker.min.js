define(["jquery","core/ajax","core/templates","core/notification","core/url"],function(a,b,c,d,e){var f=0,g=function(c){if(c.target.value){a("#panoptopicker-area").empty(),h(a("#panoptopicker-area"));var e=b.call([{methodname:"repository_panopto_get_session_by_id",args:{sessionid:c.target.value,contextid:f}}]);e[0].done(function(a){i(a)}).fail(function(a){a.backtrace=null,d.exception(a)})}},h=function(b){b.addClass("updating");var c=b.find("img.spinner");c.length?c.show():(c=a("<img/>").attr("src",e.imageUrl("i/loading_small")).addClass("spinner").addClass("smallicon"),b.append(c))},i=function(b){var e={};b.session&&a.extend(e,b.session),c.render("repository_panopto/form_panoptopicker",e).done(function(b){a("#panoptopicker-area").empty().append(a(b).html())}).fail(d.exception)};return{init:function(b){f=b.contextid,a("#"+b.elementid).on("change",g).trigger("change")}}});